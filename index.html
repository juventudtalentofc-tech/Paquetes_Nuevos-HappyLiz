<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sistema de Licencia - Soporte Técnico 2026</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* RESET Y CONFIGURACIÓN BÁSICA */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }
        
        /* CONTROL DE SCROLL Y ZOOM */
        html {
            height: 100%;
            overflow: hidden;
        }
        
        body {
            height: 100%;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
            background: #f8f9fa;
            color: #333;
        }
        
        /* Permitir scroll pero controlado */
        .license-screen {
            min-height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        /* Prevenir zoom pero permitir desplazamiento */
        @media (pointer: coarse) {
            body {
                touch-action: pan-y;
            }
        }
        
        /* Pantalla de bloqueo por licencia */
        .license-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            z-index: 10000;
            overflow-y: auto;
            padding: 20px;
        }
        
        .license-container {
            background: white;
            border-radius: 12px;
            padding: 40px;
            max-width: 800px;
            width: 100%;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            margin: auto;
            position: relative;
        }
        
        /* Header profesional */
        .license-header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .company-logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 32px;
        }
        
        .license-title {
            font-size: 28px;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 10px;
        }
        
        .license-subtitle {
            font-size: 16px;
            color: #718096;
            line-height: 1.6;
            max-width: 600px;
            margin: 0 auto;
        }
        
        /* Información del sistema - Estilo empresarial */
        .system-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .info-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            border-left: 4px solid #667eea;
        }
        
        .info-label {
            font-size: 12px;
            color: #718096;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .info-value {
            font-size: 16px;
            color: #2d3748;
            font-weight: 500;
            font-family: 'SF Mono', 'Monaco', 'Inconsolata', monospace;
        }
        
        /* Sección de licencia */
        .license-section {
            background: #f1f5f9;
            border-radius: 8px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid #e2e8f0;
        }
        
        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            color: #667eea;
        }
        
        /* Precio y detalles */
        .price-container {
            display: flex;
            align-items: center;
            gap: 30px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .price-tag {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            border-radius: 8px;
            text-align: center;
            min-width: 150px;
        }
        
        .price-amount {
            font-size: 36px;
            font-weight: 700;
            line-height: 1;
        }
        
        .price-period {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .features-list {
            flex: 1;
        }
        
        .feature-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            color: #4a5568;
        }
        
        .feature-item i {
            color: #48bb78;
        }
        
        /* Input de serial */
        .serial-container {
            background: white;
            border-radius: 8px;
            padding: 25px;
            border: 2px solid #e2e8f0;
            margin-bottom: 25px;
        }
        
        .serial-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 10px;
        }
        
        .serial-input-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .serial-input {
            flex: 1;
            min-width: 250px;
            padding: 15px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            font-size: 16px;
            font-family: 'SF Mono', 'Monaco', 'Inconsolata', monospace;
            letter-spacing: 1px;
            color: #2d3748;
        }
        
        .serial-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        /* Botones profesionales */
        .action-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 14px 28px;
            border-radius: 6px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            flex: 1;
            min-width: 200px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }
        
        .btn-secondary {
            background: white;
            color: #667eea;
            border: 2px solid #e2e8f0;
        }
        
        .btn-secondary:hover {
            background: #f7fafc;
            border-color: #667eea;
        }
        
        /* Contador de intentos */
        .attempts-warning {
            background: #fed7d7;
            border: 1px solid #fc8181;
            border-radius: 6px;
            padding: 15px;
            margin-top: 20px;
            display: none;
            align-items: center;
            gap: 10px;
            color: #c53030;
            font-size: 14px;
        }
        
        .attempts-warning.active {
            display: flex;
        }
        
        /* Footer corporativo */
        .license-footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid #e9ecef;
            color: #718096;
            font-size: 14px;
        }
        
        .contact-info {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .contact-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s ease;
        }
        
        .contact-item:hover {
            color: #764ba2;
        }
        
        /* Modales */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10001;
            padding: 20px;
        }
        
        .modal-overlay.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 40px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
        }
        
        .modal-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .modal-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            margin: 0 auto 20px;
        }
        
        .modal-title {
            font-size: 24px;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 10px;
        }
        
        .modal-text {
            color: #718096;
            line-height: 1.6;
            margin-bottom: 30px;
            text-align: center;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .license-container {
                padding: 30px 20px;
                margin: 10px;
            }
            
            .price-container {
                flex-direction: column;
                align-items: stretch;
            }
            
            .price-tag {
                width: 100%;
            }
            
            .serial-input-group {
                flex-direction: column;
            }
            
            .serial-input {
                min-width: 100%;
            }
            
            .btn {
                min-width: 100%;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .contact-info {
                flex-direction: column;
                gap: 15px;
                align-items: center;
            }
            
            .system-info {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .license-container {
                padding: 20px 15px;
            }
            
            .license-title {
                font-size: 24px;
            }
            
            .section-title {
                font-size: 18px;
            }
            
            .modal-content {
                padding: 25px 20px;
            }
        }
        
        /* Animaciones sutiles */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .license-container {
            animation: fadeIn 0.3s ease-out;
        }
        
        /* Estilos para el contenido principal (cuando se desbloquea) */
        #mainContent {
            display: none;
            min-height: 100vh;
            background: white;
        }
        
        .app-header {
            background: white;
            padding: 20px 40px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .app-title {
            font-size: 24px;
            font-weight: 600;
            color: #2d3748;
        }
        
        .license-status {
            background: #c6f6d5;
            color: #22543d;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .app-content {
            padding: 40px;
            max-width: 1200px;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <!-- Pantalla de bloqueo por licencia -->
    <div class="license-screen" id="licenseScreen">
        <div class="license-container">
            <div class="license-header">
                <div class="company-logo">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <h1 class="license-title">Sistema de Licencia Requerido</h1>
                <p class="license-subtitle">
                    El acceso a este sistema de soporte técnico requiere una licencia válida. 
                    Para continuar, active su licencia existente o adquiera una nueva suscripción.
                </p>
            </div>
            
            <div class="system-info">
                <div class="info-card">
                    <div class="info-label">ID del Sistema</div>
                    <div class="info-value" id="systemId">SRV-2026-8C4A9B3D</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Última Verificación</div>
                    <div class="info-value" id="checkDate">26/03/2026 14:30</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Estado</div>
                    <div class="info-value" style="color: #e53e3e;">LICENCIA REQUERIDA</div>
                </div>
            </div>
            
            <div class="license-section">
                <h2 class="section-title">
                    <i class="fas fa-key"></i>
                    Activar Licencia de Soporte
                </h2>
                
                <div class="price-container">
                    <div class="price-tag">
                        <div class="price-amount">$11.00</div>
                        <div class="price-period">por año</div>
                    </div>
                    
                    <div class="features-list">
                        <div class="feature-item">
                            <i class="fas fa-check-circle"></i>
                            <span>Soporte técnico prioritario 24/7</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-check-circle"></i>
                            <span>Actualizaciones de seguridad garantizadas</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-check-circle"></i>
                            <span>Acceso a todas las funcionalidades</span>
                        </div>
                        <div class="feature-item">
                            <i class="fas fa-check-circle"></i>
                            <span>Certificación y cumplimiento</span>
                        </div>
                    </div>
                </div>
                
                <div class="serial-container">
                    <label class="serial-label">Introduzca su clave de licencia:</label>
                    <div class="serial-input-group">
                        <input type="text" class="serial-input" id="serialInput" 
                               placeholder="XXXX-XXXX-XXXX-XXXX" maxlength="19">
                        <button class="btn btn-primary" id="activateBtn">
                            <i class="fas fa-unlock"></i>
                            Activar Licencia
                        </button>
                    </div>
                    
                    <div class="attempts-warning" id="attemptsWarning">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>Intentos restantes: <span id="attemptsLeft">3</span> - Contacte soporte si necesita ayuda</span>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" id="buyLicenseBtn">
                        <i class="fas fa-shopping-cart"></i>
                        Adquirir Nueva Licencia
                    </button>
                    <button class="btn btn-secondary" id="contactSupportBtn">
                        <i class="fas fa-headset"></i>
                        Contactar Soporte Técnico
                    </button>
                </div>
            </div>
            
            <div class="license-footer">
                <p>© 2026 Sistema de Soporte Técnico. Todos los derechos reservados.</p>
                <p>El uso no autorizado de este software está estrictamente prohibido.</p>
                
                <div class="contact-info">
                    <a href="mailto:soporte@tecnico2026.com" class="contact-item">
                        <i class="fas fa-envelope"></i>
                        soporte@tecnico2026.com
                    </a>
                    <a href="tel:+15551234567" class="contact-item">
                        <i class="fas fa-phone"></i>
                        +1 (555) 123-4567
                    </a>
                    <a href="https://licencias.tecnico2026.com" class="contact-item">
                        <i class="fas fa-globe"></i>
                        licencias.tecnico2026.com
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal de compra -->
    <div class="modal-overlay" id="purchaseModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-icon">
                    <i class="fas fa-credit-card"></i>
                </div>
                <h2 class="modal-title">Proceso de Adquisición</h2>
                <p class="modal-text">
                    Será redirigido a nuestro portal seguro de pagos para completar la transacción.
                    Recibirá su clave de licencia por email inmediatamente después del pago.
                </p>
            </div>
            
            <div class="action-buttons">
                <button class="btn btn-primary" id="confirmPurchaseBtn">
                    <i class="fas fa-external-link-alt"></i>
                    Continuar al Portal de Pagos
                </button>
                <button class="btn btn-secondary" id="cancelPurchaseBtn">
                    Cancelar
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modal de activación exitosa -->
    <div class="modal-overlay" id="successModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-icon">
                    <i class="fas fa-check"></i>
                </div>
                <h2 class="modal-title">Licencia Activada</h2>
                <p class="modal-text">
                    Su licencia ha sido activada exitosamente. El sistema se reiniciará automáticamente.
                </p>
            </div>
            
            <div class="system-info" style="margin: 30px 0; background: #f1f5f9; padding: 20px; border-radius: 8px;">
                <div class="info-card" style="border-left-color: #48bb78;">
                    <div class="info-label">Licencia</div>
                    <div class="info-value" id="activatedSerial">SRV-PRO-2026-ABCD1234</div>
                </div>
                <div class="info-card" style="border-left-color: #48bb78;">
                    <div class="info-label">Válida hasta</div>
                    <div class="info-value" id="expiryDate">26/03/2027</div>
                </div>
            </div>
            
            <button class="btn btn-primary" id="continueBtn">
                <i class="fas fa-play"></i>
                Continuar al Sistema
            </button>
        </div>
    </div>
    
    <!-- Modal de error -->
    <div class="modal-overlay" id="errorModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-icon" style="background: #e53e3e;">
                    <i class="fas fa-times"></i>
                </div>
                <h2 class="modal-title">Error de Activación</h2>
                <p class="modal-text" id="errorMessage">
                    La clave de licencia introducida no es válida o ha expirado.
                </p>
            </div>
            
            <button class="btn btn-secondary" id="closeErrorBtn">
                <i class="fas fa-redo"></i>
                Intentar Nuevamente
            </button>
        </div>
    </div>

    <!-- Contenido principal (oculto hasta activación) -->
    <div id="mainContent">
        <header class="app-header">
            <div class="app-title">
                <i class="fas fa-tools"></i>
                Sistema de Soporte Técnico 2026
            </div>
            <div class="license-status">
                <i class="fas fa-shield-alt"></i>
                Licencia Professional Activa
            </div>
        </header>
        
        <div class="app-content">
            <h1>Panel de Control Principal</h1>
            <p>Bienvenido al sistema de soporte técnico. Todas las funcionalidades están ahora disponibles.</p>
            
            <div class="system-info" style="margin-top: 30px;">
                <div class="info-card">
                    <div class="info-label">Usuario Activo</div>
                    <div class="info-value">admin@empresa.com</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Sesión Iniciada</div>
                    <div class="info-value" id="sessionTime">26/03/2026 14:35</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Estado del Sistema</div>
                    <div class="info-value" style="color: #48bb78;">OPERATIVO</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configuración del sistema
        const SYSTEM_CONFIG = {
            price: 11.00,
            validLicenses: [
                "SRV-PRO-2026-ABCD1234",
                "SRV-ENT-2026-EFGH5678",
                "SRV-TECH-2026-IJKL9012",
                "SRV-SUPPORT-2026-MNOP3456",
                "SRV-PREMIUM-2026-QRST7890"
            ],
            maxAttempts: 3,
            licenseDuration: 365 // días
        };
        
        // Estado del sistema
        let systemState = {
            isLicensed: false,
            attemptsLeft: SYSTEM_CONFIG.maxAttempts,
            systemId: generateSystemId(),
            lastCheck: getCurrentDateTime(),
            enteredLicense: ""
        };
        
        // Elementos del DOM
        const licenseScreen = document.getElementById('licenseScreen');
        const mainContent = document.getElementById('mainContent');
        const systemIdElement = document.getElementById('systemId');
        const checkDateElement = document.getElementById('checkDate');
        const serialInput = document.getElementById('serialInput');
        const attemptsWarning = document.getElementById('attemptsWarning');
        const attemptsLeftElement = document.getElementById('attemptsLeft');
        
        // Modales
        const purchaseModal = document.getElementById('purchaseModal');
        const successModal = document.getElementById('successModal');
        const errorModal = document.getElementById('errorModal');
        
        // Inicialización
        document.addEventListener('DOMContentLoaded', function() {
            // Configurar información del sistema
            systemIdElement.textContent = systemState.systemId;
            checkDateElement.textContent = systemState.lastCheck;
            
            // Verificar licencia existente
            checkExistingLicense();
            
            // Configurar eventos
            setupEventListeners();
            
            // Formatear input de licencia
            formatLicenseInput();
            
            // Actualizar hora de sesión
            updateSessionTime();
        });
        
        // Generar ID del sistema
        function generateSystemId() {
            const timestamp = Date.now().toString(36).toUpperCase();
            const random = Math.random().toString(36).substr(2, 6).toUpperCase();
            return `SRV-2026-${timestamp.substr(-4)}${random.substr(0, 4)}`;
        }
        
        // Obtener fecha y hora actual
        function getCurrentDateTime() {
            const now = new Date();
            return now.toLocaleDateString('es-ES') + ' ' + now.toLocaleTimeString('es-ES', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
        }
        
        // Verificar licencia existente
        function checkExistingLicense() {
            const savedLicense = localStorage.getItem('supportSystemLicense');
            if (savedLicense) {
                try {
                    const licenseData = JSON.parse(savedLicense);
                    const expiryDate = new Date(licenseData.expiryDate);
                    const today = new Date();
                    
                    if (expiryDate > today && SYSTEM_CONFIG.validLicenses.includes(licenseData.licenseKey)) {
                        systemState.isLicensed = true;
                        unlockSystem(licenseData.licenseKey, licenseData.expiryDate);
                    }
                } catch (e) {
                    console.error('Error al cargar licencia:', e);
                }
            }
        }
        
        // Configurar event listeners
        function setupEventListeners() {
            // Botón de comprar licencia
            document.getElementById('buyLicenseBtn').addEventListener('click', function() {
                purchaseModal.classList.add('active');
            });
            
            // Botón de contactar soporte
            document.getElementById('contactSupportBtn').addEventListener('click', function() {
                window.open('mailto:soporte@tecnico2026.com?subject=Soporte%20Técnico%20-%20Licencia', '_blank');
            });
            
            // Botón de activar licencia
            document.getElementById('activateBtn').addEventListener('click', activateLicense);
            
            // Confirmar compra
            document.getElementById('confirmPurchaseBtn').addEventListener('click', function() {
                simulatePayment();
                purchaseModal.classList.remove('active');
            });
            
            // Cancelar compra
            document.getElementById('cancelPurchaseBtn').addEventListener('click', function() {
                purchaseModal.classList.remove('active');
            });
            
            // Continuar al sistema
            document.getElementById('continueBtn').addEventListener('click', function() {
                successModal.classList.remove('active');
                unlockSystem(systemState.enteredLicense, calculateExpiryDate());
            });
            
            // Cerrar error
            document.getElementById('closeErrorBtn').addEventListener('click', function() {
                errorModal.classList.remove('active');
                serialInput.focus();
            });
            
            // Activar con Enter
            serialInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    activateLicense();
                }
            });
        }
        
        // Formatear input de licencia
        function formatLicenseInput() {
            serialInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/[^A-Z0-9-]/gi, '');
                value = value.replace(/(.{4})(?=.)/g, '$1-');
                e.target.value = value.substring(0, 19).toUpperCase();
            });
        }
        
        // Activar licencia
        function activateLicense() {
            const licenseKey = serialInput.value.trim().toUpperCase();
            
            if (!licenseKey) {
                showError('Por favor, introduzca una clave de licencia válida.');
                return;
            }
            
            if (systemState.attemptsLeft <= 0) {
                showError('Ha excedido el número máximo de intentos. Contacte a soporte técnico.');
                return;
            }
            
            // Verificar licencia
            if (SYSTEM_CONFIG.validLicenses.includes(licenseKey)) {
                // Licencia válida
                systemState.enteredLicense = licenseKey;
                systemState.attemptsLeft = SYSTEM_CONFIG.maxAttempts;
                
                // Mostrar éxito
                document.getElementById('activatedSerial').textContent = licenseKey;
                successModal.classList.add('active');
                attemptsWarning.classList.remove('active');
            } else {
                // Licencia inválida
                systemState.attemptsLeft--;
                updateAttemptsWarning();
                
                if (systemState.attemptsLeft > 0) {
                    showError(`Clave de licencia inválida. Intentos restantes: ${systemState.attemptsLeft}`);
                } else {
                    showError('Clave de licencia inválida. Ha agotado todos los intentos. Contacte a soporte técnico.');
                    attemptsWarning.classList.add('active');
                }
                
                serialInput.value = '';
                serialInput.focus();
            }
        }
        
        // Simular procesamiento de pago
        function simulatePayment() {
            // En producción, aquí iría la integración con la pasarela de pagos
            
            // Generar una licencia aleatoria para la demostración
            const randomLicense = SYSTEM_CONFIG.validLicenses[
                Math.floor(Math.random() * SYSTEM_CONFIG.validLicenses.length)
            ];
            
            // Mostrar diálogo con la licencia
            const paymentResult = `
                ✅ PAGO PROCESADO EXITOSAMENTE
                
                Clave de licencia generada:
                ${randomLicense}
                
                Esta clave ha sido enviada a su correo electrónico.
                Cópiela y péguela en el campo de activación.
            `;
            
            alert(paymentResult);
            
            // Autorellenar el campo de licencia
            serialInput.value = randomLicense;
            serialInput.focus();
        }
        
        // Mostrar error
        function showError(message) {
            document.getElementById('errorMessage').textContent = message;
            errorModal.classList.add('active');
        }
        
        // Actualizar advertencia de intentos
        function updateAttemptsWarning() {
            attemptsLeftElement.textContent = systemState.attemptsLeft;
            if (systemState.attemptsLeft < SYSTEM_CONFIG.maxAttempts) {
                attemptsWarning.classList.add('active');
            }
        }
        
        // Calcular fecha de expiración
        function calculateExpiryDate() {
            const expiryDate = new Date();
            expiryDate.setDate(expiryDate.getDate() + SYSTEM_CONFIG.licenseDuration);
            return expiryDate;
        }
        
        // Desbloquear sistema
        function unlockSystem(licenseKey, expiryDate) {
            // Guardar licencia
            const licenseData = {
                licenseKey: licenseKey,
                expiryDate: expiryDate.toISOString(),
                activationDate: new Date().toISOString(),
                systemId: systemState.systemId
            };
            
            localStorage.setItem('supportSystemLicense', JSON.stringify(licenseData));
            
            // Ocultar pantalla de licencia
            licenseScreen.style.display = 'none';
            mainContent.style.display = 'block';
            systemState.isLicensed = true;
            
            // Actualizar interfaz
            updateSessionTime();
            
            // Registrar activación
            console.log(`Sistema desbloqueado con licencia: ${licenseKey}`);
        }
        
        // Actualizar hora de sesión
        function updateSessionTime() {
            const sessionTimeElement = document.getElementById('sessionTime');
            if (sessionTimeElement) {
                sessionTimeElement.textContent = getCurrentDateTime();
            }
        }
        
        // Función para pruebas
        window.testLicenseSystem = function() {
            console.log('Estado del sistema:', systemState);
            console.log('Licencia guardada:', localStorage.getItem('supportSystemLicense'));
        };
    </script>
</body>
</html>
